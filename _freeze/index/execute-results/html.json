{
  "hash": "b7896e2c7ab3017e6525a45f1d887e11",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"An Analysis of Lichess Chess Matches\"\nauthor: \"Ana Luisa Bodevan\"\ndate:  \"11-05-2025\"\nexecute:\n  warning: false\n  message: false\n  eval: true\nformat:\n  html:\n    code-tools: true\n    code-fold: true\ntoc: true \n---\n\nThis is a project of data cleaning and analysis of data of +20.000 Lichess chess matches. The objective is to explore common matches patterns and identify variables that may influence in the match outcome.\n\n## Technology and Data\n\n-   Python\n    -   Pandas, NumPy\n    -   Matplotlib, Plotly\n\nData is from the Chess Game Dataset (Lichess) on [Kaggle](https://www.kaggle.com/datasets/datasnaek/chess/data).\n\n### Data Description\n\n`Game ID`;\n\n`Rated` (T/F);\n\n`Start Time`; `End Time`;\n\n`Number of Turns`;\n\n`Game Status`; `Winner`;\n\n`Time Increment`;\n\n`White Player ID`; `White Player Rating`;\n\n`Black Player ID`; `Black Player Rating`;\n\n`All Moves in Standard Chess Notation`;\n\n`Opening Eco` (Standardised Code for any given opening); `Opening Name`; `Opening Ply` (Number of moves in the opening phase)\n\n## 0. Setup and Cleaning Data\n\nThe `data_cleaning.py` script cleaned the original `games.csv` dataset and saved it as `games_clean.csv`. The process was quick and easy, given that the data was already very well structured. There were no missing values, and the only necessary changes were cleaning out duplicate data and creating a column for openings without their variants, for simplicity.\n\n## 1. Descriptive Analysis\n\nThe `eda.py` script generated the insights presented. The following code load the necessary libraries, data and calculates the `rating_difference` variable.\n\n::: {#setup .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport plotly.express as px\n\n# Load Data\ndf = pd.read_csv('data/games_clean.csv')\n\n# Feature Engineering\ndf['rating_difference'] = df['white_rating'] - df['black_rating']\n```\n:::\n\n\n### 1.1 Summary Statistics\n\nThe table below provides a summary of the core numerical features, highlighting the central tendencies and spread of the data.\n\n::: {#cell-descriptive-stats .cell tbl-cap='Summary Statistics of Numerical Features' execution_count=2}\n``` {.python .cell-code}\nnumerical_cols = ['turns', 'white_rating', 'black_rating', 'opening_ply', 'rating_difference']\ndf[numerical_cols].describe().round(2)\n```\n\n::: {#descriptive-stats .cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>turns</th>\n      <th>white_rating</th>\n      <th>black_rating</th>\n      <th>opening_ply</th>\n      <th>rating_difference</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>19429.00</td>\n      <td>19429.00</td>\n      <td>19429.00</td>\n      <td>19429.00</td>\n      <td>19429.00</td>\n    </tr>\n    <tr>\n      <th>mean</th>\n      <td>61.06</td>\n      <td>1597.70</td>\n      <td>1589.91</td>\n      <td>4.84</td>\n      <td>7.79</td>\n    </tr>\n    <tr>\n      <th>std</th>\n      <td>33.14</td>\n      <td>288.14</td>\n      <td>288.83</td>\n      <td>2.79</td>\n      <td>246.12</td>\n    </tr>\n    <tr>\n      <th>min</th>\n      <td>3.00</td>\n      <td>784.00</td>\n      <td>789.00</td>\n      <td>1.00</td>\n      <td>-1605.00</td>\n    </tr>\n    <tr>\n      <th>25%</th>\n      <td>38.00</td>\n      <td>1401.00</td>\n      <td>1395.00</td>\n      <td>3.00</td>\n      <td>-106.00</td>\n    </tr>\n    <tr>\n      <th>50%</th>\n      <td>56.00</td>\n      <td>1568.00</td>\n      <td>1563.00</td>\n      <td>4.00</td>\n      <td>3.00</td>\n    </tr>\n    <tr>\n      <th>75%</th>\n      <td>79.00</td>\n      <td>1792.00</td>\n      <td>1784.00</td>\n      <td>6.00</td>\n      <td>121.00</td>\n    </tr>\n    <tr>\n      <th>max</th>\n      <td>349.00</td>\n      <td>2700.00</td>\n      <td>2621.00</td>\n      <td>28.00</td>\n      <td>1499.00</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n-   **Ratings**: The average rating for both players is high (around 1600), but the range is vast **288** points).\n\n-   **Game Length**: The mean game length is **61.06** turns (median 56), showing a slight positive skew (more short games than very long ones).\n\n-   **Rating Difference**: The mean difference is **7.79** (White - Black), suggesting White is, on average, the slightly higher-rated player. However, the large standard deviation **246.12** confirms significant rating disparities exist in many individual matchups.\n\n### 1.2 Feature Correlation\n\nThe correlation matrix reveals the linear relationships between the numerical variables.\n\n![](output/correlation_matrix_heatmap.png){fig-align=\"center\" width=\"687\"}\n\n-   **Player Matching:** The strongest correlation is between `white_rating` and `black_rating` (\\$\\\\mathbf{0.64}\\$), confirming that players are typically matched against opponents of a similar skill level.\n\n-   **Rating vs. Outcome Potential:** The `rating_difference` is strongly correlated with `white_rating` (0.42) and negatively correlated with `black_rating` (-0.43). This confirms the engineered feature is highly predictive of the rating skew towards one color.\n\n-   **Turns:** Game length has only a weak correlation with ratings (0.12 to 0.15).\n\n## 2. Game Outcome Analysis\n\n### 2.1 Winner and Victory Stats Distribution\n\n![](output/victory_winner_distributions.png)\n\n-   **Winner:** White wins the largest share of games, consistent with the first-move advantage in chess.\n\n-   **Victory Status:** **Resignation** is the most common end-game status, followed by **Checkmate**, suggesting players know they are rarely able to revert a losing position.\n\n### 2.2 Rating Influence on Outcome\n\nThe histogram below shows the distribution of the rating difference, separated by the winner.\n\n![](output/rating_difference_by_winner_hist.png){fig-align=\"center\" width=\"683\"}\n\nThe distributions are distinctly separated. The mass of the \"white\" wins is centered where White had a positive rating advantage, and the mass of the \"black\" wins is centered where Black had a positive rating advantage (negative rating difference). This visually confirms that the **higher-rated player is more likely to win**, regardless of color.\n\n### 2.3 Game Lenght by Victory Status\n\nThe box plot illustrates the typical number of turns required for each victory status.\n\n![](output/turns_by_victory_status_boxplot.png){fig-align=\"center\" width=\"798\"}\n\n**Observations:**\n\n-   **Longest Games:** Games ending in a **Draw** tend to be the longest (highest median and upper quartile), as balanced positions require extensive play.\n\n-   **Resignation/Mate:** These outcomes occur at a similar median game length, suggesting that decisive mistakes or tactical breakthroughs happen mid-game.\n\n## 3. Opening Analysis\n\n### 3.1 Top 10 Openings Winning Rate\n\n::: {#cell-top-10-openings-win-rates-table .cell tbl-cap='Winning Rates for Top 10 Most Frequent Openings (%)' execution_count=3}\n``` {.python .cell-code}\ntop_openings = df['opening_name'].value_counts().nlargest(10).index.tolist()\ndf_top_openings = df[df['opening_name'].isin(top_openings)]\nopening_win_counts = df_top_openings.groupby('opening_name')['winner'].value_counts().unstack(fill_value=0)\ntotal_games = opening_win_counts.sum(axis=1)\nopening_win_rates = opening_win_counts.divide(total_games, axis=0) * 100\nopening_win_rates = opening_win_rates.sort_values(by='white', ascending=False)\nopening_win_rates[['white', 'black', 'draw']].round(2)\n```\n\n::: {#top-10-openings-win-rates-table .cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>winner</th>\n      <th>white</th>\n      <th>black</th>\n      <th>draw</th>\n    </tr>\n    <tr>\n      <th>opening_name</th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>Scandinavian Defense: Mieses-Kotroc Variation</th>\n      <td>62.85</td>\n      <td>34.78</td>\n      <td>2.37</td>\n    </tr>\n    <tr>\n      <th>Italian Game: Two Knights Defense</th>\n      <td>54.81</td>\n      <td>41.84</td>\n      <td>3.35</td>\n    </tr>\n    <tr>\n      <th>Scotch Game</th>\n      <td>53.41</td>\n      <td>42.42</td>\n      <td>4.17</td>\n    </tr>\n    <tr>\n      <th>Horwitz Defense</th>\n      <td>51.98</td>\n      <td>45.54</td>\n      <td>2.48</td>\n    </tr>\n    <tr>\n      <th>Queen's Pawn Game: Mason Attack</th>\n      <td>50.43</td>\n      <td>44.35</td>\n      <td>5.22</td>\n    </tr>\n    <tr>\n      <th>French Defense: Knight Variation</th>\n      <td>50.19</td>\n      <td>44.53</td>\n      <td>5.28</td>\n    </tr>\n    <tr>\n      <th>Queen's Pawn Game: Chigorin Variation</th>\n      <td>48.66</td>\n      <td>47.77</td>\n      <td>3.57</td>\n    </tr>\n    <tr>\n      <th>Sicilian Defense</th>\n      <td>41.86</td>\n      <td>53.78</td>\n      <td>4.36</td>\n    </tr>\n    <tr>\n      <th>Sicilian Defense: Bowdler Attack</th>\n      <td>40.48</td>\n      <td>55.10</td>\n      <td>4.42</td>\n    </tr>\n    <tr>\n      <th>Van't Kruijs Opening</th>\n      <td>33.23</td>\n      <td>62.02</td>\n      <td>4.75</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n-   **White's Best:** The **Scandinavian Defense: Mieses-Kotroc Variation** heavily favors White, who wins **62.85** of the time.\n\n-   **Black's Best:** The **Van't Kruijs Opening** heavily favors Black, who wins **62%** of the time. This suggests that White's non-standard opening choice is often punished.\n\n## 4. Conclusions \n\nThe primary factor influencing the game outcome is the **rating difference** between the players, confirming that the higher-rated participant is statistically favored to win, regardless of playing color. White maintains a slight overall winning edge, supporting the notion of the first-move advantage.\n\nGame endings are predominantly characterized by **resignation** or **checkmate** rather than time or draw-related outcomes, indicating a decisive result is achieved in the majority of contests. Furthermore, the analysis of popular openings revealed substantial imbalances, with specific lines, such as the Scandinavian Defense: Mieses-Kotroc Variation and the Van't Kruijs Opening, showing stark bias toward one color.\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}